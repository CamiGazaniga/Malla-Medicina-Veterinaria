<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Malla Curricular Veterinaria</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;700&display=swap" rel="stylesheet" />
  <style>
    :root {
      --bg-pink: #fff1f7;
      --accent-pink: #f472b6;
    }
    body {
      background-color: var(--bg-pink);
      background-image: url('https://i.imgur.com/pkX7cYH.png');
      background-repeat: repeat;
      background-size: 120px;
      font-family: 'Fredoka', sans-serif;
      color: #4b1e2f;
    }
    .completed {
      text-decoration: line-through;
      opacity: 0.6;
    }
    summary {
      transition: color 0.3s ease;
    }
    summary:hover {
      color: #ec4899;
    }
    details {
      border: 1px solid #f9a8d4;
      border-radius: 1rem;
      background: white;
    }
  </style>
</head>
<body class="p-6">
  <h1 class="text-5xl font-extrabold text-center text-pink-600 mb-10">
    ğŸ¾ Malla Curricular de Medicina Veterinaria y Zootecnia ğŸ¾
  </h1>
  <div id="malla" class="space-y-6 max-w-4xl mx-auto"></div>

  <!-- Enlace correcto al archivo de cursos -->
  <script src="cursos.js"></script>
  <script>
    function guardarProgreso(completados) {
      localStorage.setItem("cursosCompletados", JSON.stringify([...completados]));
    }

    function cargarProgreso() {
      const datos = localStorage.getItem("cursosCompletados");
      return datos ? new Set(JSON.parse(datos)) : new Set();
    }

    function prerrequisitosCompletos(prereqs, completados) {
      return prereqs.every(p => completados.has(p));
    }

    function crearCurso(curso, completados, actualizar) {
      const div = document.createElement("div");
      div.className = "flex items-center space-x-3 py-1";
      const check = document.createElement("input");
      check.type = "checkbox";
      check.className = "accent-pink-500 w-4 h-4";
      check.checked = completados.has(curso.id);
      check.disabled = !prerrequisitosCompletos(curso.prereqs, completados);

      const label = document.createElement("label");
      const emojis = ["ğŸ¶","ğŸ±","ğŸ®","ğŸ·","ğŸ”","ğŸ¦Š","ğŸ¦","ğŸ¦‰","ğŸ´"];
      const emoji = emojis[Math.floor(Math.random() * emojis.length)];
      label.textContent = `${emoji} ${curso.nombre} | CrÃ©ditos: ${curso.creditos}`;
      if (check.checked) label.classList.add("completed");

      check.addEventListener("change", () => {
        if (check.checked) completados.add(curso.id);
        else completados.delete(curso.id);
        guardarProgreso(completados);
        actualizar();
      });

      div.appendChild(check);
      div.appendChild(label);
      return div;
    }

    function renderizarMalla() {
      const cont = document.getElementById("malla");
      cont.innerHTML = "";
      const completados = cargarProgreso();
      for (const ciclo in cursos) {
        const details = document.createElement("details");
        details.className = "rounded-2xl shadow-lg p-4";
        details.open = true;

        const summary = document.createElement("summary");
        summary.className = "text-2xl font-bold text-pink-700 mb-2 cursor-pointer";
        summary.textContent = ciclo;

        details.appendChild(summary);
        cursos[ciclo].forEach(curso => {
          details.appendChild(crearCurso(curso, completados, renderizarMalla));
        });
        cont.appendChild(details);
      }
    }

    document.addEventListener("DOMContentLoaded", renderizarMalla);
  </script>
</body>
</html>
